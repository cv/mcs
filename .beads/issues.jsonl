{"id":"mcs-1","title":"Initialize Go module and project structure","description":"Create go.mod, directory structure (cmd/cx90, internal/api, internal/config, internal/cli)","status":"closed","priority":0,"issue_type":"feature","created_at":"2025-12-18T00:17:33.514372-08:00","updated_at":"2025-12-18T22:36:26.034539-08:00","closed_at":"2025-12-18T00:24:48.770456-08:00"}
{"id":"mcs-10","title":"Implement root CLI command","description":"Version flag, help, config path display, cobra root setup","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-18T00:17:43.537957-08:00","updated_at":"2025-12-18T22:36:26.036228-08:00","closed_at":"2025-12-18T00:36:59.078451-08:00","dependencies":[{"issue_id":"mcs-10","depends_on_id":"mcs-2","type":"blocks","created_at":"2025-12-18T00:18:01.88321-08:00","created_by":"carlosvillela"},{"issue_id":"mcs-10","depends_on_id":"mcs-9","type":"blocks","created_at":"2025-12-18T00:18:01.889795-08:00","created_by":"carlosvillela"}]}
{"id":"mcs-11","title":"Implement status command","description":"cx90 status with subcommands: battery, fuel, location, tires, doors. Human-readable and --json output","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-18T00:17:43.543139-08:00","updated_at":"2025-12-18T22:36:26.036003-08:00","closed_at":"2025-12-18T00:53:26.855614-08:00","dependencies":[{"issue_id":"mcs-11","depends_on_id":"mcs-10","type":"blocks","created_at":"2025-12-18T00:18:07.194671-08:00","created_by":"carlosvillela"},{"issue_id":"mcs-11","depends_on_id":"mcs-6","type":"blocks","created_at":"2025-12-18T00:18:07.199414-08:00","created_by":"carlosvillela"},{"issue_id":"mcs-11","depends_on_id":"mcs-7","type":"blocks","created_at":"2025-12-18T00:18:07.203873-08:00","created_by":"carlosvillela"}]}
{"id":"mcs-12","title":"Implement lock/unlock commands","description":"cx90 lock, cx90 unlock with --yes flag to skip confirmation","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-18T00:17:43.547819-08:00","updated_at":"2025-12-18T22:36:26.042793-08:00","closed_at":"2025-12-18T00:54:26.997324-08:00","dependencies":[{"issue_id":"mcs-12","depends_on_id":"mcs-10","type":"blocks","created_at":"2025-12-18T00:18:07.209377-08:00","created_by":"carlosvillela"},{"issue_id":"mcs-12","depends_on_id":"mcs-8","type":"blocks","created_at":"2025-12-18T00:18:07.215147-08:00","created_by":"carlosvillela"}]}
{"id":"mcs-13","title":"Implement start/stop commands","description":"cx90 start (remote start), cx90 stop (stop engine)","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-18T00:17:43.552355-08:00","updated_at":"2025-12-18T22:36:26.04259-08:00","closed_at":"2025-12-18T00:55:24.580242-08:00","dependencies":[{"issue_id":"mcs-13","depends_on_id":"mcs-10","type":"blocks","created_at":"2025-12-18T00:18:07.221048-08:00","created_by":"carlosvillela"},{"issue_id":"mcs-13","depends_on_id":"mcs-8","type":"blocks","created_at":"2025-12-18T00:18:07.226248-08:00","created_by":"carlosvillela"}]}
{"id":"mcs-14","title":"Implement charge commands","description":"cx90 charge start, cx90 charge stop","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-18T00:17:43.556858-08:00","updated_at":"2025-12-18T22:36:26.042389-08:00","closed_at":"2025-12-18T00:56:54.474374-08:00","dependencies":[{"issue_id":"mcs-14","depends_on_id":"mcs-10","type":"blocks","created_at":"2025-12-18T00:18:07.230776-08:00","created_by":"carlosvillela"},{"issue_id":"mcs-14","depends_on_id":"mcs-8","type":"blocks","created_at":"2025-12-18T00:18:07.234897-08:00","created_by":"carlosvillela"}]}
{"id":"mcs-15","title":"Implement climate commands","description":"cx90 climate on/off/set \u003ctemp\u003e/defrost","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-18T00:17:43.561036-08:00","updated_at":"2025-12-18T22:36:26.042188-08:00","closed_at":"2025-12-18T00:57:57.917391-08:00","dependencies":[{"issue_id":"mcs-15","depends_on_id":"mcs-10","type":"blocks","created_at":"2025-12-18T00:18:07.239455-08:00","created_by":"carlosvillela"},{"issue_id":"mcs-15","depends_on_id":"mcs-8","type":"blocks","created_at":"2025-12-18T00:18:07.244136-08:00","created_by":"carlosvillela"}]}
{"id":"mcs-16","title":"Implement raw debug commands","description":"cx90 raw status, cx90 raw ev - output raw JSON from API","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-12-18T00:17:43.565243-08:00","updated_at":"2025-12-18T22:36:26.045121-08:00","closed_at":"2025-12-18T00:59:12.867538-08:00","dependencies":[{"issue_id":"mcs-16","depends_on_id":"mcs-10","type":"blocks","created_at":"2025-12-18T00:18:07.248145-08:00","created_by":"carlosvillela"},{"issue_id":"mcs-16","depends_on_id":"mcs-6","type":"blocks","created_at":"2025-12-18T00:18:07.252491-08:00","created_by":"carlosvillela"},{"issue_id":"mcs-16","depends_on_id":"mcs-7","type":"blocks","created_at":"2025-12-18T00:18:07.256685-08:00","created_by":"carlosvillela"}]}
{"id":"mcs-17","title":"Implement token caching","description":"Cache access token in ~/.cache/cx90/token.json, check expiration, refresh when needed","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-18T00:17:49.423185-08:00","updated_at":"2025-12-18T22:36:26.041989-08:00","closed_at":"2025-12-18T01:27:53.601686-08:00","dependencies":[{"issue_id":"mcs-17","depends_on_id":"mcs-4","type":"blocks","created_at":"2025-12-18T00:18:07.260882-08:00","created_by":"carlosvillela"}]}
{"id":"mcs-18","title":"Add pretty terminal output","description":"Colored output, progress bars for battery/fuel, formatted tables","status":"open","priority":3,"issue_type":"feature","created_at":"2025-12-18T00:17:49.427952-08:00","updated_at":"2025-12-18T22:36:26.044841-08:00","dependencies":[{"issue_id":"mcs-18","depends_on_id":"mcs-11","type":"blocks","created_at":"2025-12-18T00:18:07.26603-08:00","created_by":"carlosvillela"}]}
{"id":"mcs-19","title":"Add shell completions","description":"cx90 completion bash/zsh/fish","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-12-18T00:17:49.432188-08:00","updated_at":"2025-12-18T22:36:26.044642-08:00","closed_at":"2025-12-18T01:20:42.336885-08:00","dependencies":[{"issue_id":"mcs-19","depends_on_id":"mcs-10","type":"blocks","created_at":"2025-12-18T00:18:07.271686-08:00","created_by":"carlosvillela"}]}
{"id":"mcs-2","title":"Add cobra and viper dependencies","description":"go get cobra, viper for CLI framework and config management","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-18T00:17:33.519847-08:00","updated_at":"2025-12-18T22:36:26.037365-08:00","closed_at":"2025-12-18T00:26:01.604305-08:00","dependencies":[{"issue_id":"mcs-2","depends_on_id":"mcs-1","type":"blocks","created_at":"2025-12-18T00:18:01.829145-08:00","created_by":"carlosvillela"}]}
{"id":"mcs-20","title":"Add Google Maps link to location output","description":"When displaying location info (cx90 status location), include a clickable Google Maps URL like https://maps.google.com/?q=LAT,LON","status":"closed","priority":3,"issue_type":"task","created_at":"2025-12-18T01:50:32.591602-08:00","updated_at":"2025-12-18T22:36:26.044462-08:00","closed_at":"2025-12-18T01:51:37.517925-08:00"}
{"id":"mcs-21","title":"Fix unsafe type assertions in status.go and getInternalVIN","description":"Multiple unguarded type assertions can panic at runtime:\n- getInternalVIN (status.go:177-199) - panic on unexpected vehicle format\n- extractBatteryInfo (status.go:266-278) - panic on missing EV data\n- extractClimateInfo, extractTireInfo, etc.\n\nAll map[string]interface{} type assertions should use safe form:\n  val, ok := data[\"key\"].(Type)\n  if !ok { return error }\n\nFiles: internal/cli/status.go","design":"## Fix locations:\n- getInternalVIN (status.go:177-199) - 3 unsafe assertions\n- extractBatteryInfo (266-278) - 6 unsafe\n- extractClimateInfo - 4 unsafe\n- extractTireInfo - 3 unsafe\n- extractDoorInfo - 4 unsafe\n\nBetter approach: implement mcs-23 first, then json.Unmarshal handles safety","acceptance_criteria":"- [ ] All type assertions use safe form with ok check\n- [ ] Appropriate error messages for type mismatches\n- [ ] No panic possible from API response parsing\n- [ ] All tests pass","status":"closed","priority":0,"issue_type":"bug","created_at":"2025-12-18T03:19:07.034509-08:00","updated_at":"2025-12-18T22:36:26.033604-08:00","closed_at":"2025-12-18T03:42:55.543567-08:00","dependencies":[{"issue_id":"mcs-21","depends_on_id":"mcs-23","type":"related","created_at":"2025-12-18T03:20:19.967059-08:00","created_by":"carlosvillela"}]}
{"id":"mcs-22","title":"Extract common CLI setup boilerplate into helper","description":"All CLI command handlers (lock.go, engine.go, charge.go, climate.go, raw.go) contain ~25 identical lines:\n  client, err := createAPIClient()\n  defer saveClientCache(client)\n  vecBaseInfos, err := client.GetVecBaseInfos()\n  internalVIN, err := getInternalVIN(vecBaseInfos)\n\nThis pattern repeats 10+ times totaling ~200 lines.\n\nCreate helper:\n  func withVehicleClient(fn func(*api.Client, string) error) error\n\nFiles: internal/cli/lock.go, engine.go, charge.go, climate.go, raw.go","design":"## Helper signature:\n```go\nfunc withVehicleClient(fn func(*api.Client, string) error) error\n```\n\nThen each command becomes:\n```go\nfunc runLock(cmd *cobra.Command, args []string) error {\n    return withVehicleClient(func(client *api.Client, vin string) error {\n        return client.DoorLock(vin)\n    })\n}\n```\n\nFiles: lock.go, engine.go, charge.go, climate.go, raw.go","acceptance_criteria":"- [ ] withVehicleClient helper exists in client.go\n- [ ] All 10 command handlers use the helper\n- [ ] No duplicate client setup code remains\n- [ ] All tests pass\n- [ ] golangci-lint passes","status":"closed","priority":0,"issue_type":"chore","created_at":"2025-12-18T03:19:24.764835-08:00","updated_at":"2025-12-18T22:36:26.033367-08:00","closed_at":"2025-12-18T03:46:33.38379-08:00"}
{"id":"mcs-23","title":"Define typed structs for API responses instead of map[string]interface{}","description":"The entire API layer uses map[string]interface{} for responses. This causes:\n- Unsafe type assertions throughout the code\n- No compile-time type checking  \n- Poor discoverability of available fields\n- Runtime panic risk\n\nDefine structs like:\n  type EVVehicleStatus struct {\n    ResultCode string\n    ResultData []EVResultData\n  }\n  type ChargeInfo struct {\n    SmaphSOC float64\n    SmaphRemDrvDistKm float64\n    ...\n  }\n\nFiles: internal/api/vehicle.go, internal/cli/status.go","design":"## Strategy:\n1. Create internal/api/types.go with response structs\n2. Use `mcs raw status` and `mcs raw ev` to capture real JSON for struct definitions\n3. Update API methods to return typed responses\n4. This naturally fixes mcs-21 (unsafe type assertions)\n\nNote: InternalVIN field comes as float64 OR string - use interface{} or custom unmarshaler","acceptance_criteria":"- [ ] internal/api/types.go exists with response structs\n- [ ] GetVecBaseInfos returns typed response\n- [ ] GetVehicleStatus returns typed response\n- [ ] GetEVVehicleStatus returns typed response\n- [ ] No map[string]interface{} in public API signatures\n- [ ] All tests pass","status":"closed","priority":0,"issue_type":"chore","created_at":"2025-12-18T03:19:24.817991-08:00","updated_at":"2025-12-18T22:36:26.032842-08:00","closed_at":"2025-12-18T03:42:51.407977-08:00"}
{"id":"mcs-24","title":"Consolidate duplicate control functions in API layer","description":"All 11 control functions (DoorLock, DoorUnlock, EngineStart, etc.) in control.go have identical structure:\n  bodyParams := map[string]interface{}{...}\n  response, err := c.APIRequest(...)\n  if resultCode != \"200S00\" { return error }\n\nExtract generic helper:\n  func (c *Client) executeControlCommand(internalVIN, endpoint, actionDesc string) error\n\nReduces ~200 lines to ~30 lines.\n\nFiles: internal/api/control.go","design":"## All 11 endpoints follow same pattern:\ndoorLock, doorUnLock, lightOn, lightOff, engineStart, engineStop, evChargeStart, evChargeStop, hvacOn, hvacOff, vehicleStatus\n\nExtract:\n```go\nfunc (c *Client) executeControl(endpoint, action, internalVIN string) error\n```\n\nEach public method becomes one-liner calling executeControl.","acceptance_criteria":"- [ ] executeControl helper function exists\n- [ ] All 11 control functions use the helper\n- [ ] Each public function is ≤5 lines\n- [ ] All tests pass","status":"closed","priority":1,"issue_type":"chore","created_at":"2025-12-18T03:19:24.876602-08:00","updated_at":"2025-12-18T22:36:26.035807-08:00","closed_at":"2025-12-18T11:10:40.232391-08:00"}
{"id":"mcs-25","title":"Complete or remove incomplete test stubs","description":"Several test functions contain placeholder comments like 'Test will be implemented when APIRequest exists' but APIRequest already exists:\n- client_test.go:99-100\n- client_test.go:125-126\n- client_test.go:152-153\n- client_test.go:262-264\n- client_test.go:301-303\n- client_test.go:343-344\n\nEither complete the tests or remove the stubs.\n\nFiles: internal/api/client_test.go","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-18T03:19:24.936813-08:00","updated_at":"2025-12-18T22:36:26.035589-08:00","closed_at":"2025-12-18T11:16:20.174023-08:00"}
{"id":"mcs-26","title":"Refactor CLI tests to use table-driven pattern","description":"Tests for status subcommands (battery, fuel, location, tires, doors) repeat same pattern:\n  cmd := NewStatusCmd()\n  for _, subCmd := range cmd.Commands() {\n    if subCmd.Use == \"battery\" { ... }\n  }\n\nConvert to table-driven test:\n  subcommands := []string{\"battery\", \"fuel\", \"location\", \"tires\", \"doors\"}\n  for _, name := range subcommands {\n    t.Run(name, func(t *testing.T) { ... })\n  }\n\nAlso deduplicate test client setup using shared fixtures.\n\nFiles: internal/cli/status_test.go, internal/api/vehicle_test.go","acceptance_criteria":"- [ ] Subcommand tests use table-driven pattern\n- [ ] Test client setup uses shared helper\n- [ ] Tests clearly document expected behavior\n- [ ] No duplicate test setup code\n- [ ] All tests pass","status":"closed","priority":1,"issue_type":"chore","created_at":"2025-12-18T03:19:24.991759-08:00","updated_at":"2025-12-18T22:36:26.035364-08:00","closed_at":"2025-12-18T11:19:43.041731-08:00","dependencies":[{"issue_id":"mcs-26","depends_on_id":"mcs-25","type":"related","created_at":"2025-12-18T03:20:22.636349-08:00","created_by":"carlosvillela"}]}
{"id":"mcs-27","title":"Add context.Context support to API client","description":"The API client doesn't support Go's context.Context for cancellation and timeouts. This is important for CLI applications where users might want to cancel long-running operations.\n\nAdd context parameter to API methods:\n  func (c *Client) APIRequest(ctx context.Context, method, uri string, ...) error\n  func (c *Client) DoorLock(ctx context.Context, internalVIN string) error\n\nFiles: internal/api/client.go, control.go, vehicle.go","design":"## Migration:\n1. Add ctx param to APIRequest, use http.NewRequestWithContext\n2. Update control.go and vehicle.go functions\n3. CLI: use cmd.Context() from cobra or context.WithTimeout\n\nStart with context.TODO() during migration, replace incrementally","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-18T03:19:25.041813-08:00","updated_at":"2025-12-18T22:36:26.035167-08:00","closed_at":"2025-12-18T11:34:23.679134-08:00"}
{"id":"mcs-28","title":"Replace custom base64Encode with stdlib","description":"A custom base64 encoding function (30 lines) is implemented when Go's standard library provides this.\n\nLocation: internal/api/auth.go:379-410\n\nReplace with:\n  encoding/base64.StdEncoding.EncodeToString(data)\n\nwhich is already used elsewhere in the codebase (crypto.go:32).","status":"closed","priority":1,"issue_type":"chore","created_at":"2025-12-18T03:19:47.250193-08:00","updated_at":"2025-12-18T22:36:26.034948-08:00","closed_at":"2025-12-18T11:09:39.669959-08:00"}
{"id":"mcs-29","title":"Remove hardcoded vehicle model from status output","description":"The vehicle model is hardcoded in status.go:223:\n  output := \"\\nCX-90 GT PHEV (2025)\\n\"\n\nThis should be extracted from vecBaseInfos or made configurable to support other vehicle models.\n\nFiles: internal/cli/status.go","design":"## Options:\n1. Extract from vecBaseInfos response (preferred) - look for CarName/ModelName/ModelYear fields\n2. Add to config.toml as fallback\n\nRun `mcs raw status` to see actual JSON structure for field names","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-12-18T03:19:47.315867-08:00","updated_at":"2025-12-18T22:36:26.034754-08:00","closed_at":"2025-12-18T11:08:33.964914-08:00"}
{"id":"mcs-3","title":"Implement crypto utilities","description":"AES-128-CBC encryption/decryption, RSA-ECB-PKCS1 password encryption, MD5/SHA256 signing, device ID generation from email hash","status":"closed","priority":0,"issue_type":"feature","created_at":"2025-12-18T00:17:33.525784-08:00","updated_at":"2025-12-18T22:36:26.034314-08:00","closed_at":"2025-12-18T00:29:19.579439-08:00","dependencies":[{"issue_id":"mcs-3","depends_on_id":"mcs-1","type":"blocks","created_at":"2025-12-18T00:18:01.834357-08:00","created_by":"carlosvillela"}]}
{"id":"mcs-30","title":"Consolidate duplicated crypto functions (PKCS7, AES)","description":"The following functions are implemented twice:\n\n1. pkcs7Pad - internal/api/crypto.go:128-158 AND internal/sensordata/sensor_data.go:277-285\n\n2. encryptAES128CBC - internal/api/crypto.go:18-33 AND internal/sensordata/sensor_data.go:260-275\n\nMove to a shared internal/crypto utility package.","status":"closed","priority":2,"issue_type":"chore","created_at":"2025-12-18T03:19:47.399102-08:00","updated_at":"2025-12-18T22:36:26.041815-08:00","closed_at":"2025-12-18T11:36:54.035746-08:00"}
{"id":"mcs-31","title":"Extract __INTERNAL_ID__ magic string to constant","description":"The string \"__INTERNAL_ID__\" is hardcoded in every API request body:\n- vehicle.go:8,17,42\n- control.go (11 occurrences)\n\nDefine as constant:\n  const InternalUserID = \"__INTERNAL_ID__\"","status":"closed","priority":2,"issue_type":"chore","created_at":"2025-12-18T03:19:47.457635-08:00","updated_at":"2025-12-18T22:36:26.041639-08:00","closed_at":"2025-12-18T11:11:47.668267-08:00"}
{"id":"mcs-32","title":"Clean up unused code: PrintConfigPath, NewInvalidRegionError","description":"Unused functions should be removed or used:\n\n1. PrintConfigPath (root.go:76-83) - defined but never called\n   → Either remove or add a 'config' subcommand\n\n2. NewInvalidRegionError (errors.go:60-62) - defined but NewClient uses fmt.Errorf instead\n   → Either use it in auth.go:97 or remove it","status":"closed","priority":2,"issue_type":"chore","created_at":"2025-12-18T03:19:47.521121-08:00","updated_at":"2025-12-18T22:36:26.041464-08:00","closed_at":"2025-12-18T11:37:48.820789-08:00"}
{"id":"mcs-33","title":"Standardize error message capitalization to lowercase","description":"Error messages use inconsistent capitalization:\n\n  return fmt.Errorf(\"Failed to get vehicle status...\")  // Capital F\n  return fmt.Errorf(\"failed to get vehicle info...\")    // lowercase f\n\nGo convention is lowercase. Standardize all error messages.\n\nFiles: internal/api/vehicle.go, control.go","status":"closed","priority":2,"issue_type":"chore","created_at":"2025-12-18T03:19:47.576667-08:00","updated_at":"2025-12-18T22:36:26.041288-08:00","closed_at":"2025-12-18T11:12:09.078319-08:00"}
{"id":"mcs-34","title":"Consolidate region validation to single source of truth","description":"Region validation exists in two places:\n- RegionConfigs map in auth.go:51-67\n- validRegions map in config.go:18-23\n\nThe config package should reference the API package's RegionConfigs instead of duplicating.","status":"closed","priority":2,"issue_type":"chore","created_at":"2025-12-18T03:20:02.045053-08:00","updated_at":"2025-12-18T22:36:26.041111-08:00","closed_at":"2025-12-18T11:38:32.133483-08:00"}
{"id":"mcs-35","title":"Create InternalVIN type alias for documentation","description":"The internal VIN is passed as plain string everywhere with no type safety or documentation.\n\nConsider:\n  type InternalVIN string\n  func (v InternalVIN) String() string { return string(v) }\n\nMinor improvement for code documentation.","status":"closed","priority":3,"issue_type":"chore","created_at":"2025-12-18T03:20:02.138104-08:00","updated_at":"2025-12-18T22:36:26.044282-08:00","closed_at":"2025-12-18T11:12:27.36902-08:00"}
{"id":"mcs-36","title":"Extract verbose debug logging to helper method","description":"Debug logging in sendAPIRequest (client.go:157-191) is inline and clutters main logic.\n\nExtract to helper:\n  func (c *Client) logRequest(method, url string, headers map[string]string, body string)","status":"closed","priority":3,"issue_type":"chore","created_at":"2025-12-18T03:20:02.211295-08:00","updated_at":"2025-12-18T22:36:26.044086-08:00","closed_at":"2025-12-18T11:41:13.172202-08:00"}
{"id":"mcs-37","title":"Extract generic JSON/text formatting helper","description":"Each format*Status function in status.go (426-551) has the same pattern for JSON output:\n  if jsonOutput {\n    data := map[string]interface{}{...}\n    jsonBytes, _ := json.MarshalIndent(data, \"\", \"  \")\n    return string(jsonBytes)\n  }\n\nExtract helper:\n  func formatOutput(data interface{}, textFn func() string, json bool) string","status":"open","priority":3,"issue_type":"chore","created_at":"2025-12-18T03:20:02.27639-08:00","updated_at":"2025-12-18T22:36:26.043909-08:00"}
{"id":"mcs-38","title":"Extract touch event generation helper in sensordata","description":"The same event generation pattern (down event, move events, up event) is repeated 3 times in TouchEventList.Randomize (touch_event.go:41-140).\n\nExtract helper:\n  func (t *TouchEventList) addTouchSequence(baseTime int)","status":"closed","priority":3,"issue_type":"chore","created_at":"2025-12-18T03:20:02.334158-08:00","updated_at":"2025-12-18T22:36:26.043735-08:00","closed_at":"2025-12-18T12:18:07.245077-08:00"}
{"id":"mcs-39","title":"Add Homebrew tap support to goreleaser","description":"The .goreleaser.yml is missing Homebrew tap configuration. This would allow users to install via:\n  brew install mysmartcar/tap/mcs\n\nNeeds a brews: section added to .goreleaser.yml pointing to a homebrew-tap repository.","design":"## Add to .goreleaser.yml:\n\n```yaml\nbrews:\n  - repository:\n      owner: cv\n      name: taps\n      token: \"{{ .Env.HOMEBREW_TAP_GITHUB_TOKEN }}\"\n    directory: Formula\n    homepage: https://github.com/cv/mcs\n    description: CLI for controlling your connected vehicle\n    license: MIT\n    install: |\n      bin.install \"mcs\"\n    test: |\n      system \"#{bin}/mcs\", \"--version\"\n```\n\n## Prerequisites:\n1. Add HOMEBREW_TAP_GITHUB_TOKEN secret to CI\n\nAfter release, users can install via:\n  brew install cv/taps/mcs","acceptance_criteria":"- [ ] brews section added to .goreleaser.yml\n- [ ] homebrew-tap repository exists\n- [ ] CI has HOMEBREW_TAP_GITHUB_TOKEN secret\n- [ ] `brew install cv/tap/mcs` works after release","notes":"Taps repo: https://github.com/cv/taps","status":"in_progress","priority":2,"issue_type":"feature","created_at":"2025-12-18T03:26:30.908772-08:00","updated_at":"2025-12-18T22:36:26.040921-08:00"}
{"id":"mcs-4","title":"Implement authentication flow","description":"checkVersion endpoint for enc/sign keys, usher encryptionKey for RSA pubkey, usher login for access token, token refresh logic","status":"closed","priority":0,"issue_type":"feature","created_at":"2025-12-18T00:17:33.531077-08:00","updated_at":"2025-12-18T22:36:26.034082-08:00","closed_at":"2025-12-18T00:34:52.678031-08:00","dependencies":[{"issue_id":"mcs-4","depends_on_id":"mcs-3","type":"blocks","created_at":"2025-12-18T00:18:01.839684-08:00","created_by":"carlosvillela"}]}
{"id":"mcs-40","title":"Add climate set command for temperature and defroster control","description":"Add `mcs climate set` command to configure HVAC temperature and defrosters.\n\n## API Details\nEndpoint: `remoteServices/updateHVACSetting/v4`\nMethod: POST\n\nBody parameters (in addition to standard internaluserid/internalvin):\n- `Temperature`: float (desired temperature)\n- `TemperatureType`: int (1=Celsius, 2=Fahrenheit)\n- `FrontDefroster`: int (0=off, 1=on)\n- `RearDefogger`: int (0=off, 1=on)\n\nReference: github.com/ungineer/pymazda controller.py `set_hvac_setting()`\n\n## Implementation Notes\n1. Add `SetHVACSetting(internalVIN, temp float64, tempUnit string, frontDefrost, rearDefrost bool)` to `internal/api/control.go`\n   - Cannot reuse `executeControl()` since this needs additional body params\n   - Validate tempUnit is \"c\" or \"f\", convert to 1 or 2\n2. Add `climate set` subcommand in `internal/cli/climate.go`\n   - Flags: `--temp`, `--unit` (default \"c\"), `--front-defrost`, `--rear-defrost`\n   - At minimum `--temp` should be required\n3. Add tests for new API method and CLI command\n\n## Acceptance Criteria\n- [ ] `mcs climate set --temp 22` sets temperature to 22°C\n- [ ] `mcs climate set --temp 72 --unit f` sets temperature to 72°F\n- [ ] `mcs climate set --temp 20 --front-defrost` enables front defroster\n- [ ] `mcs climate set --rear-defrost=false` can disable rear defroster\n- [ ] Invalid unit values rejected with clear error\n- [ ] Unit tests cover API method and CLI flag parsing","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-18T11:32:06.084534-08:00","updated_at":"2025-12-18T22:36:26.040729-08:00","closed_at":"2025-12-18T11:40:16.455692-08:00"}
{"id":"mcs-41","title":"Replace map[string]interface{} with typed structs for API responses","description":"The API package extensively uses map[string]interface{} for responses instead of typed structs. This leads to unsafe type assertions throughout the code (e.g., auth.go:196-197) that can panic at runtime.\n\nAffected areas:\n- GetEncryptionKeys parses into map[string]interface{} (auth.go:176)\n- GetUsherEncryptionKey returns from map[string]interface{} (auth.go:229-242)  \n- Login parses into map[string]interface{} (auth.go:294)\n- APIRequest returns map[string]interface{} (client.go:19)\n- decryptPayloadUsingKey returns map[string]interface{} (client.go:256)\n\nSuggested structs:\n- EncryptionKeysResponse\n- LoginResponse  \n- VehicleInfoResponse\n- etc.\n\nThis should also fix the unsafe type assertions like:\n  c.encKey = decrypted[\"encKey\"].(string) // panics if nil\n\nUse two-return form: encKey, ok := decrypted[\"encKey\"].(string)","notes":"Scope clarification: The main vehicle status responses now use typed structs (types.go), but the auth flow still uses map[string]interface{} extensively in auth.go and client.go. Focus on adding structs for EncryptionKeysResponse, LoginResponse, and UsherEncryptionKeyResponse.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T11:50:46.761906-08:00","updated_at":"2025-12-18T22:36:26.040527-08:00","closed_at":"2025-12-18T12:08:47.921021-08:00"}
{"id":"mcs-42","title":"Add test coverage for sensordata package","description":"The sensordata package has zero test coverage. This is critical anti-bot functionality that needs testing.\n\nMissing tests:\n- SensorDataBuilder.GenerateSensorData()\n- Individual event list randomization (TouchEvent, MotionEvent, OrientationEvent, DeviceInfoEvent)\n- SystemInfo.ToString() and GetCharCodeSum()\n- encryptSensorData function\n- Helper functions: feistelCipher, countSeparators\n\nConsider:\n- Unit tests for each event type's Randomize() method\n- Integration test for full sensor data generation\n- Edge case testing for the encryption functions","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T11:50:46.811404-08:00","updated_at":"2025-12-18T22:36:26.040331-08:00","closed_at":"2025-12-18T12:11:52.972721-08:00"}
{"id":"mcs-42q","title":"Extract generic response conversion helper in api package","description":"## Problem\n`internal/api/vehicle.go` repeats the same marshal/unmarshal pattern 3 times:\n\n```go\njsonBytes, err := json.Marshal(response)\nif err != nil { return nil, fmt.Errorf(\"...\") }\nif err := json.Unmarshal(jsonBytes, \u0026typed); err != nil { return nil, fmt.Errorf(\"...\") }\n```\n\nLocations:\n- `GetVecBaseInfos()` lines 21-31\n- `GetVehicleStatus()` lines 50-66  \n- `GetEVVehicleStatus()` lines 84-100\n\n## Solution\nCreate a generic helper:\n\n```go\nfunc unmarshalResponse[T any](response map[string]interface{}) (*T, error) {\n    jsonBytes, err := json.Marshal(response)\n    if err != nil {\n        return nil, fmt.Errorf(\"failed to marshal response: %w\", err)\n    }\n    var result T\n    if err := json.Unmarshal(jsonBytes, \u0026result); err != nil {\n        return nil, fmt.Errorf(\"failed to unmarshal response: %w\", err)\n    }\n    return \u0026result, nil\n}\n```\n\n## Impact\n~30 lines of duplicate code removed.","status":"closed","priority":3,"issue_type":"chore","created_at":"2025-12-18T23:07:47.764207-08:00","updated_at":"2025-12-18T23:17:04.256468-08:00","closed_at":"2025-12-18T23:17:04.256468-08:00","close_reason":"Added generic unmarshalResponse[T] helper, refactored 3 functions, 27 lines removed, tests added"}
{"id":"mcs-43","title":"Extract duplicate token validation logic","description":"Token validation logic is duplicated between:\n- Client.IsTokenValid() in internal/api/auth.go:322-327\n- TokenCache.IsValid() in internal/cache/cache.go:20-25\n\nBoth check for empty token and expired timestamp with identical logic.\n\nSuggested fix: Have Client.IsTokenValid() delegate to a shared validation method, or have Client create a TokenCache internally and delegate to its IsValid() method.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T11:50:46.860115-08:00","updated_at":"2025-12-18T22:36:26.040148-08:00","closed_at":"2025-12-18T12:13:15.195717-08:00"}
{"id":"mcs-44","title":"Define constants for API error codes","description":"Error codes are hardcoded magic numbers throughout internal/api/client.go:201-215.\n\nCurrent code:\n  case 600001:\n      return nil, NewEncryptionError()\n  case 600002:\n      return nil, NewTokenExpiredError()  \n  case 920000:\n      if extraCode == \"400S01\" { ... }\n\nSuggested fix - define named constants:\n  const (\n      ErrorCodeEncryption        = 600001\n      ErrorCodeTokenExpired      = 600002\n      ErrorCodeRequestIssue      = 920000\n      ExtraCodeRequestInProgress = \"400S01\"\n      ExtraCodeEngineStartLimit  = \"400S11\"\n  )","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T11:50:46.912662-08:00","updated_at":"2025-12-18T22:36:26.039969-08:00","closed_at":"2025-12-18T12:14:01.71072-08:00"}
{"id":"mcs-45","title":"Use strings.Builder in sensordata generation","description":"The GenerateSensorData method in internal/sensordata/sensor_data.go:65-111 uses extensive string concatenation with += which is inefficient in Go.\n\nCurrent: result += sdkVersion + \"-1,2,-94,-100,\"\n\nSuggested fix:\n  var sb strings.Builder\n  sb.WriteString(sdkVersion)\n  sb.WriteString(\"-1,2,-94,-100,\")\n  // ...\n  return encryptSensorData(sb.String())\n\nThis also applies to the repetitive touch event generation in touch_event.go:35-141 which has three nearly identical code blocks.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T12:01:11.93625-08:00","updated_at":"2025-12-18T22:36:26.039792-08:00","closed_at":"2025-12-18T12:15:40.038361-08:00"}
{"id":"mcs-46","title":"Refactor long runStatus function","description":"The runStatus function in internal/cli/status.go:83-187 is 104 lines and handles multiple concerns:\n- Client creation\n- Refresh logic with polling\n- Display logic\n\nAdditionally, runStatus manually duplicates the withVehicleClient pattern instead of using the existing helper (unlike lock, engine, charge, climate commands which all use it).\n\nSuggested refactoring:\n1. Extract refresh polling into refreshAndWait(ctx, client, evStatus, refreshWait)\n2. Consider using withVehicleClient for consistency with other commands","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T12:01:12.009491-08:00","updated_at":"2025-12-18T22:36:26.039615-08:00","closed_at":"2025-12-18T12:17:07.472856-08:00"}
{"id":"mcs-47","title":"Create shared CLI test helpers","description":"The pattern for finding subcommands is duplicated in multiple CLI test files:\n- charge_test.go:27-33, 55-60\n- raw_test.go:27-33, 55-60\n- climate_test.go:27-33, 55-60, 82-87, 102-108\n\nOnly status_test.go has a findSubcommand helper function.\n\nThe api package has a dedicated test_helpers_test.go file - create a similar cli_test_helpers_test.go to consolidate:\n- findSubcommand helper\n- Any other shared test utilities","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T12:01:12.076624-08:00","updated_at":"2025-12-18T22:36:26.039437-08:00","closed_at":"2025-12-18T12:20:10.927264-08:00"}
{"id":"mcs-48","title":"Add type-safe TemperatureUnit enum","description":"Temperature unit in internal/api/control.go:85-94 is passed as a string and validated with a switch statement.\n\nCurrent:\n  func (c *Client) SetHVACSetting(... tempUnit string ...) error {\n      switch tempUnit {\n      case \"c\", \"C\": tempType = 1\n      case \"f\", \"F\": tempType = 2\n      ...\n      }\n  }\n\nSuggested fix - type-safe enum:\n  type TemperatureUnit int\n  const (\n      Celsius    TemperatureUnit = 1  \n      Fahrenheit TemperatureUnit = 2\n  )\n\nAlso add temperature range validation (e.g., 15-30°C, 60-86°F).","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T12:01:12.142548-08:00","updated_at":"2025-12-18T22:36:26.039243-08:00","closed_at":"2025-12-18T12:41:49.579387-08:00"}
{"id":"mcs-49","title":"Have format functions reuse extract functions for JSON output","description":"In internal/cli/status.go:251-311, the extractXxxData functions duplicate logic in the formatXxxStatus functions.\n\nExample - extractBatteryData and formatBatteryStatus both construct the same map structure when JSON output is needed:\n  \n  // extractBatteryData (lines 252-260)\n  return map[string]interface{}{\"level\": batteryLevel, \"range\": range_, ...}\n  \n  // formatBatteryStatus JSON branch (lines 314-324)\n  data := map[string]interface{}{\"level\": batteryLevel, \"range\": range_, ...}\n\nSuggested fix: Have formatBatteryStatus call extractBatteryData when jsonOutput=true to eliminate duplication.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T12:01:12.227589-08:00","updated_at":"2025-12-18T22:36:26.039063-08:00","closed_at":"2025-12-18T12:44:08.538745-08:00"}
{"id":"mcs-5","title":"Implement API client core","description":"HTTP client with proper headers (user-agent, app-version, device-id), request signing, payload encryption/decryption, error handling","status":"closed","priority":0,"issue_type":"feature","created_at":"2025-12-18T00:17:33.536932-08:00","updated_at":"2025-12-18T22:36:26.03384-08:00","closed_at":"2025-12-18T00:43:51.830466-08:00","dependencies":[{"issue_id":"mcs-5","depends_on_id":"mcs-3","type":"blocks","created_at":"2025-12-18T00:18:01.844475-08:00","created_by":"carlosvillela"},{"issue_id":"mcs-5","depends_on_id":"mcs-4","type":"blocks","created_at":"2025-12-18T00:18:01.849392-08:00","created_by":"carlosvillela"}]}
{"id":"mcs-50","title":"Remove unused contains helper in client_test.go","description":"The contains function in internal/api/client_test.go:13-15 wraps strings.Contains but provides no additional value:\n\n  func contains(s, substr string) bool {\n      return strings.Contains(s, substr)\n  }\n\nShould be removed and calls replaced with strings.Contains directly.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T12:01:12.277216-08:00","updated_at":"2025-12-18T22:36:26.038885-08:00","closed_at":"2025-12-18T12:45:09.532124-08:00"}
{"id":"mcs-51","title":"Add boolToInt helper for control.go","description":"In internal/api/control.go:96-103, boolean-to-integer conversion is verbose:\n\n  frontDefrost := 0\n  if frontDefroster {\n      frontDefrost = 1\n  }\n  rearDefrost := 0\n  if rearDefroster {\n      rearDefrost = 1\n  }\n\nSuggested fix - create a helper:\n  func boolToInt(b bool) int {\n      if b { return 1 }\n      return 0\n  }\n\nThen: frontDefrost := boolToInt(frontDefroster)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T12:01:29.461085-08:00","updated_at":"2025-12-18T22:36:26.038708-08:00","closed_at":"2025-12-18T12:46:36.032715-08:00"}
{"id":"mcs-52","title":"Standardize error message casing","description":"Error messages are inconsistent throughout the codebase:\n- Some lowercase: \"failed to create request: %w\"\n- Some uppercase: \"Request failed: %s\"\n\nGo convention: error strings should not be capitalized (unless proper nouns) and should not end with punctuation.\n\nShould audit all fmt.Errorf and error returns for consistency.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T12:01:29.51577-08:00","updated_at":"2025-12-18T22:36:26.038525-08:00","closed_at":"2025-12-18T12:02:58.460932-08:00"}
{"id":"mcs-53","title":"Extract touch event generation helper","description":"In internal/sensordata/touch_event.go:35-141, the Randomize method has three nearly identical code blocks for generating touch events (down, move, up) with only slight variations in timestamp offset logic.\n\nSuggested fix: Extract a helper method like generateTouchSequence(timestampOffset int, eventType string) to reduce repetition and improve maintainability.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-18T12:01:29.602601-08:00","updated_at":"2025-12-18T22:36:26.038351-08:00","closed_at":"2025-12-18T12:01:56.50459-08:00"}
{"id":"mcs-54","title":"Investigate undisplayed data from mcs status endpoints","description":"Investigate what information comes back from the endpoints in `mcs status` that we're not currently displaying and that could be interesting to users.\n\n## Background\nThe `mcs status` command displays a subset of the data returned by the API. There may be additional useful fields that users would find valuable.\n\n## Tasks\n- [ ] Review raw API responses from status endpoints\n- [ ] Compare returned fields vs what's currently displayed\n- [ ] Identify potentially interesting undisplayed data\n- [ ] Document findings and recommend which fields to add\n\n## Approach\nUse `mcs raw` or add debug logging to see full API responses, then compare against what `internal/cli/status.go` currently extracts and displays.","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-12-18T20:15:10.528737-08:00","updated_at":"2025-12-18T22:36:26.043561-08:00","closed_at":"2025-12-18T20:24:35.018336-08:00"}
{"id":"mcs-55","title":"Display odometer reading in mcs status","description":"Add odometer reading to `mcs status` output.\n\n## API Field\n- Source: `remoteInfos[].DriveInformation.OdoDispValue`\n- Type: float64\n- Unit: kilometers\n\n## Implementation\n1. Add `DriveInformation` struct to `types.go`:\n   ```go\n   type DriveInformation struct {\n       OdoDispValue float64 `json:\"OdoDispValue\"`\n   }\n   ```\n2. Add `DriveInformation DriveInformation` to `RemoteInfo` struct\n3. Add `GetOdometerInfo()` helper method to `VehicleStatusResponse`\n4. Update `displayAllStatus()` in `status.go` to show odometer\n5. Consider adding `mcs status odometer` subcommand\n\n## Display Format\n```\nODOMETER: 12,345.6 km\n```\n\n## Priority\nHigh - users frequently want to track mileage\n\n## Verified\nField confirmed to exist in API response (see undisplayed_fields_test.go)","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-18T20:23:42.854778-08:00","updated_at":"2025-12-18T22:36:26.038171-08:00","closed_at":"2025-12-18T20:29:27.188992-08:00"}
{"id":"mcs-56","title":"Display charging time estimates in mcs status","description":"Add charging time estimates to `mcs status` output for EV/PHEV vehicles.\n\n## API Fields\n- `ChargeInfo.MaxChargeMinuteAC` (float64) - Minutes to full via AC charging\n- `ChargeInfo.MaxChargeMinuteQBC` (float64) - Minutes to full via quick charging\n\n## Implementation\n1. Add fields to `ChargeInfo` struct in `types.go`:\n   ```go\n   MaxChargeMinuteAC  float64 `json:\"MaxChargeMinuteAC\"`\n   MaxChargeMinuteQBC float64 `json:\"MaxChargeMinuteQBC\"`\n   ```\n2. Update `GetBatteryInfo()` to return these values\n3. Update battery display to show time remaining when charging\n\n## Display Format\nWhen plugged in and charging:\n```\nBATTERY: 45% (120.5 km range) [charging, ~2h 30m to full]\n```\nOr with quick charge available:\n```\nBATTERY: 45% (120.5 km range) [charging, ~45m quick / ~3h AC]\n```\n\n## Priority\nHigh - critical info for EV owners planning charging stops\n\n## Verified\nFields confirmed to exist in API response (see undisplayed_fields_test.go)","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-18T20:24:25.288916-08:00","updated_at":"2025-12-18T22:36:26.037984-08:00","closed_at":"2025-12-18T20:32:02.441944-08:00"}
{"id":"mcs-57","title":"Display individual door and trunk status in mcs status","description":"Show individual door open/closed and lock status instead of just \"all locked\".\n\n## API Fields (Door status - open/closed)\n- `Door.DrStatDrv` (float64) - Driver door (0=closed, 1=open)\n- `Door.DrStatPsngr` (float64) - Passenger door\n- `Door.DrStatRl` (float64) - Rear left door\n- `Door.DrStatRr` (float64) - Rear right door\n- `Door.DrStatTrnkLg` (float64) - Trunk (already parsed but not shown)\n- `Door.DrStatHood` (float64) - Hood\n\n## API Fields (Lock status)\n- `Door.LockLinkSwDrv` (float64) - Driver door lock\n- `Door.LockLinkSwPsngr` (float64) - Passenger door lock\n- `Door.LockLinkSwRl` (float64) - Rear left lock\n- `Door.LockLinkSwRr` (float64) - Rear right lock\n\n## Implementation\n1. Add missing fields to `DoorInfo` struct in `types.go`\n2. Update `GetDoorsInfo()` to return detailed status\n3. Update `formatDoorsStatus()` to show details\n\n## Display Format\nWhen all closed and locked:\n```\nDOORS: All locked\n```\nWhen issues exist:\n```\nDOORS: Driver unlocked, Trunk open, Hood open\n```\n\n## Priority\nMedium - useful for security awareness\n\n## Verified\nFields confirmed to exist in API response (see undisplayed_fields_test.go)","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-12-18T20:24:25.348289-08:00","updated_at":"2025-12-18T22:36:26.043382-08:00","closed_at":"2025-12-18T20:34:24.003863-08:00"}
{"id":"mcs-58","title":"Display window positions in mcs status","description":"Add window open/closed status to `mcs status` output.\n\n## API Fields\n- `Pw.PwPosDrv` (float64) - Driver window position (0=closed, \u003e0=open percentage)\n- `Pw.PwPosPsngr` (float64) - Passenger window position\n- `Pw.PwPosRl` (float64) - Rear left window position\n- `Pw.PwPosRr` (float64) - Rear right window position\n\n## Implementation\n1. Add `WindowInfo` struct to `types.go`:\n   ```go\n   type WindowInfo struct {\n       PwPosDrv   float64 `json:\"PwPosDrv\"`\n       PwPosPsngr float64 `json:\"PwPosPsngr\"`\n       PwPosRl    float64 `json:\"PwPosRl\"`\n       PwPosRr    float64 `json:\"PwPosRr\"`\n   }\n   ```\n2. Add `Pw WindowInfo` to `AlertInfo` struct\n3. Add `GetWindowsInfo()` helper method\n4. Add window status to doors display or separate section\n\n## Display Format\nWhen all closed:\n```\nWINDOWS: All closed\n```\nWhen open:\n```\nWINDOWS: Driver 50%, Rear left 25%\n```\n\n## Priority\nMedium - useful for weather awareness (did I leave windows open?)\n\n## Verified\nFields confirmed to exist in API response (see undisplayed_fields_test.go)","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-12-18T20:24:25.41544-08:00","updated_at":"2025-12-18T22:36:26.043189-08:00","closed_at":"2025-12-18T20:38:55.511258-08:00"}
{"id":"mcs-59","title":"Display hazard lights status in mcs status","description":"Add hazard lights status to `mcs status` output.\n\n## API Field\n- `HazardLamp.HazardSw` (float64) - Hazard lights (0=off, 1=on)\n\n## Implementation\n1. Add `HazardLamp` struct to `types.go`:\n   ```go\n   type HazardLamp struct {\n       HazardSw float64 `json:\"HazardSw\"`\n   }\n   ```\n2. Add `HazardLamp HazardLamp` to `AlertInfo` struct\n3. Add `GetHazardInfo()` helper method\n4. Display in status output (only when on, or always?)\n\n## Display Format\nOnly show when hazards are on:\n```\nHAZARDS: On\n```\n\n## Priority\nLow - hazards are typically temporary, but could indicate car is in distress\n\n## Verified\nField confirmed to exist in API response (see undisplayed_fields_test.go)","status":"closed","priority":4,"issue_type":"feature","created_at":"2025-12-18T20:24:25.486692-08:00","updated_at":"2025-12-18T22:36:26.045934-08:00","closed_at":"2025-12-18T20:45:23.386659-08:00"}
{"id":"mcs-6","title":"Implement vehicle status endpoint","description":"get_vehicle_status - doors, windows, locks, fuel, odometer, location, tires, hazards","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-18T00:17:33.542912-08:00","updated_at":"2025-12-18T22:36:26.037142-08:00","closed_at":"2025-12-18T00:45:44.580381-08:00","dependencies":[{"issue_id":"mcs-6","depends_on_id":"mcs-5","type":"blocks","created_at":"2025-12-18T00:18:01.854874-08:00","created_by":"carlosvillela"}]}
{"id":"mcs-60","title":"Display fuel lid status in mcs status","description":"Add fuel lid open/closed status to `mcs status` output.\n\n## API Field\n- `Door.FuelLidOpenStatus` (float64) - Fuel lid (0=closed, 1=open)\n\n## Implementation\n1. Add `FuelLidOpenStatus float64` to `DoorInfo` struct in `types.go`\n2. Include in door status display\n\n## Display Format\nOnly show when open:\n```\nDOORS: All locked, Fuel lid open\n```\n\n## Priority\nLow - edge case but useful to know\n\n## Verified\nField confirmed to exist in API response (see undisplayed_fields_test.go)","status":"closed","priority":4,"issue_type":"feature","created_at":"2025-12-18T20:24:25.560149-08:00","updated_at":"2025-12-18T22:36:26.045725-08:00","closed_at":"2025-12-18T20:47:45.269672-08:00"}
{"id":"mcs-61","title":"Display battery heater status in mcs status","description":"Add battery heater status to `mcs status` output for EV/PHEV vehicles.\n\n## API Fields\n- `ChargeInfo.BatteryHeaterON` (float64) - Battery heater running (0=off, 1=on)\n- `ChargeInfo.CstmzStatBatHeatAutoSW` (float64) - Auto setting (0=off, 1=on)\n\n## Implementation\n1. Add fields to `ChargeInfo` struct in `types.go`:\n   ```go\n   BatteryHeaterON        float64 `json:\"BatteryHeaterON\"`\n   CstmzStatBatHeatAutoSW float64 `json:\"CstmzStatBatHeatAutoSW\"`\n   ```\n2. Update battery or climate display to show heater status\n\n## Display Format\nShow in battery section when relevant (cold weather):\n```\nBATTERY: 66% (180.5 km range) [battery heater on, auto enabled]\n```\n\n## Priority\nMedium - important for cold climate EV owners\n\n## Verified\nFields confirmed to exist in API response (see undisplayed_fields_test.go)","status":"closed","priority":3,"issue_type":"feature","created_at":"2025-12-18T20:24:25.621192-08:00","updated_at":"2025-12-18T22:36:26.043006-08:00","closed_at":"2025-12-18T20:43:08.191296-08:00"}
{"id":"mcs-62","title":"Display target HVAC temperature in mcs status","description":"Add target HVAC temperature alongside interior temperature.\n\n## API Fields\n- `RemoteHvacInfo.InCarTeDC` (float64) - Current interior temp (already shown)\n- `RemoteHvacInfo.InteriorTemp` (float64) - May be same as above\n- `RemoteHvacInfo.TargetTemp` (float64) - Target/set temperature\n\n## Implementation\n1. Add `TargetTemp float64` to `RemoteHvacInfo` struct in `types.go`\n2. Update `GetHvacInfo()` to return target temp\n3. Update climate display to show both temps\n\n## Display Format\n```\nCLIMATE: On, 18°C → 22°C (front defroster on)\n```\nShows current temp (18°C) and target (22°C)\n\n## Priority\nLow - nice to have for climate control visibility\n\n## Verified\nField confirmed to exist in API response (see undisplayed_fields_test.go)","status":"closed","priority":4,"issue_type":"feature","created_at":"2025-12-18T20:24:25.681209-08:00","updated_at":"2025-12-18T22:36:26.045456-08:00","closed_at":"2025-12-18T20:53:41.704244-08:00"}
{"id":"mcs-63","title":"Display vehicle info (VIN, model, year, nickname) in mcs status","description":"Add vehicle identification info to `mcs status` output header.\n\n## API Source\nEndpoint: `remoteServices/getVecBaseInfos/v4` (already called to get internalVin)\n\n## Available Fields (from pymazda reference)\nTop-level in vecBaseInfos[]:\n- `vin` - Vehicle Identification Number\n- `nickname` - User-defined vehicle name\n- `econnectType` - Connection type\n\nIn vecBaseInfos[].Vehicle.OtherInformation:\n- `carlineName` - Model family (e.g., \"CX-90\")\n- `modelYear` - Manufacturing year  \n- `modelName` - Specific model name\n- `exteriorColorCode` / `exteriorColorName` - Color\n- `isElectric` - EV flag\n\n## Implementation\n\n1. Expand `VecBaseInfo` struct in `types.go`:\n   ```go\n   type VecBaseInfo struct {\n       VIN          string  `json:\"vin\"`\n       Nickname     string  `json:\"nickname\"`\n       EconnectType int     `json:\"econnectType\"`\n       Vehicle      Vehicle `json:\"Vehicle\"`\n   }\n   \n   type Vehicle struct {\n       CvInformation    CvInformation    `json:\"CvInformation\"`\n       OtherInformation OtherInformation `json:\"OtherInformation\"`\n   }\n   \n   type OtherInformation struct {\n       CarlineName       string `json:\"carlineName\"`\n       ModelYear         string `json:\"modelYear\"`\n       ModelName         string `json:\"modelName\"`\n       ExteriorColorName string `json:\"exteriorColorName\"`\n       IsElectric        bool   `json:\"isElectric\"`\n   }\n   ```\n\n2. Cache vehicle info in client or pass to status display\n\n3. Update status header to show vehicle info:\n   ```\n   CX-90 PHEV (2024) \"My Car\"\n   VIN: JM3KK...\n   \n   Vehicle Status (Last Updated: 2024-01-15 10:30:00)\n   \n   BATTERY: 66% ...\n   ```\n\n4. Add to JSON output under \"vehicle\" key\n\n## Display Format\n```\n\u003cModelName\u003e (\u003cYear\u003e) \"\u003cNickname\u003e\"\nVIN: \u003cVIN\u003e\n\nVehicle Status (Last Updated: ...)\n```\n\nIf no nickname: `CX-90 PHEV (2024)`\nIf no model info: Just show VIN\n\n## Acceptance Criteria\n- [ ] VIN displayed in status header\n- [ ] Model name and year displayed when available\n- [ ] Nickname displayed in quotes when set\n- [ ] JSON output includes vehicle info object\n- [ ] Works gracefully when fields are missing","status":"closed","priority":2,"issue_type":"feature","created_at":"2025-12-18T20:43:57.27877-08:00","updated_at":"2025-12-18T22:36:26.037795-08:00","closed_at":"2025-12-18T20:58:15.889942-08:00"}
{"id":"mcs-64","title":"Clarify EV vs total range labels for PHEV vehicles","description":"## Problem\n\nFor PHEV vehicles, the status display shows confusing range values:\n\n```\nBATTERY: 55% (620.0 km range)\nFUEL: 92% (620.0 km range)\n```\n\nBoth battery and fuel show identical range values, which is misleading.\n\n## Root Cause\n\nThe API returns two different range fields:\n- `SmaphRemDrvDistKm` (EV status endpoint) - EV-only range\n- `RemDrvDistDActlKm` (vehicle status endpoint) - **total combined range**, not fuel-only\n\nThe current display labels both as just \"range\", making it unclear that the fuel line shows total range.\n\n## Affected Code\n\n- `internal/cli/status.go:424` - `formatBatteryStatus()` shows \"X km range\"\n- `internal/cli/status.go:470` - `formatFuelStatus()` shows \"X km range\"\n\n## Proposed Fix\n\nUpdate display labels:\n- Battery: \"X km EV range\"\n- Fuel: \"X km total range\"\n\n## Acceptance Criteria\n\n- [ ] `mcs status` shows battery as \"BATTERY: X% (Y km EV range)\"\n- [ ] `mcs status` shows fuel as \"FUEL: X% (Y km total range)\"\n- [ ] `mcs status battery` shows \"EV range\" in output\n- [ ] `mcs status fuel` shows \"total range\" in output\n- [ ] JSON output keys remain unchanged for backwards compatibility (`range_km`)\n- [ ] Tests pass","status":"closed","priority":2,"issue_type":"bug","created_at":"2025-12-18T21:05:11.359581-08:00","updated_at":"2025-12-18T22:36:26.037599-08:00","closed_at":"2025-12-18T21:08:01.79456-08:00"}
{"id":"mcs-7","title":"Implement EV status endpoint","description":"get_ev_vehicle_status - battery level, charging status, plug state, charge times, HVAC info, battery heater","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-18T00:17:33.547876-08:00","updated_at":"2025-12-18T22:36:26.036912-08:00","closed_at":"2025-12-18T00:47:14.592071-08:00","dependencies":[{"issue_id":"mcs-7","depends_on_id":"mcs-5","type":"blocks","created_at":"2025-12-18T00:18:01.861231-08:00","created_by":"carlosvillela"}]}
{"id":"mcs-8","title":"Implement control endpoints","description":"lock/unlock doors, start/stop engine, hazards on/off, charge start/stop, HVAC on/off/settings, send POI, refresh status","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-18T00:17:43.526323-08:00","updated_at":"2025-12-18T22:36:26.036689-08:00","closed_at":"2025-12-18T00:49:15.000289-08:00","dependencies":[{"issue_id":"mcs-8","depends_on_id":"mcs-5","type":"blocks","created_at":"2025-12-18T00:18:01.867128-08:00","created_by":"carlosvillela"}]}
{"id":"mcs-9","title":"Implement config loading","description":"Load from ~/.config/cx90/config.toml, env var overrides (MYMAZDA_EMAIL, etc), viper integration","status":"closed","priority":1,"issue_type":"feature","created_at":"2025-12-18T00:17:43.531426-08:00","updated_at":"2025-12-18T22:36:26.036474-08:00","closed_at":"2025-12-18T00:30:51.322087-08:00","dependencies":[{"issue_id":"mcs-9","depends_on_id":"mcs-2","type":"blocks","created_at":"2025-12-18T00:18:01.875811-08:00","created_by":"carlosvillela"}]}
{"id":"mcs-cy2","title":"Consolidate duplicate test server helpers in api tests","description":"## Problem\nTest server creation logic is duplicated:\n- `internal/api/test_helpers_test.go:32-52` - `createSuccessServer()`, `createErrorServer()`\n- `internal/api/control_test.go:14-50` - `createControlTestServer()`\n\nBoth implement the same pattern: create httptest server that encrypts JSON responses.\n\n## Solution\nConsolidate into `test_helpers_test.go`:\n\n```go\nfunc createTestServer(t *testing.T, handler func(w http.ResponseWriter, r *http.Request)) (*httptest.Server, *Client) {\n    // Common server setup with encryption\n}\n\nfunc createJSONResponseServer(t *testing.T, response interface{}) (*httptest.Server, *Client) {\n    // Wrapper for simple JSON response cases\n}\n```\n\nUpdate `control_test.go` to use shared helpers.\n\n## Impact\n~40 lines of duplicate test code removed, more consistent test patterns.","status":"closed","priority":3,"issue_type":"chore","created_at":"2025-12-18T23:07:47.951579-08:00","updated_at":"2025-12-18T23:18:55.431547-08:00","closed_at":"2025-12-18T23:18:55.431547-08:00","close_reason":"Consolidated test server helpers with functional options pattern, ~65 lines removed"}
{"id":"mcs-hfm","title":"Remove or implement stub functions in sensordata","description":"## Problem\n8 generator functions in `internal/sensordata/sensor_data.go` return empty strings:\n- `generateEditedText()` (line 113)\n- `generateOrientationDataAA()` (line 117)\n- `generateMotionDataAA()` (line 121)\n- `generateOrientationDataAC()` (line 125)\n- `generateOrientationDataAB()` (line 129)\n- `generateMotionDataAC()` (line 133)\n- `generateMotionEvent()` (line 137)\n- `generateStoredStackTraces()` (line 179)\n\n## Context\nThese are placeholders from the Python port. The anti-bot fingerprinting works without them, but they add noise to the codebase.\n\n## Options\n1. **Remove entirely** - Delete functions and their call sites if not needed\n2. **Implement** - Port remaining logic from reference implementation if needed for edge cases\n\n## Recommendation\nRemove them. The current implementation passes authentication without these values.","status":"closed","priority":3,"issue_type":"chore","created_at":"2025-12-18T23:07:47.579543-08:00","updated_at":"2025-12-18T23:13:44.7771-08:00","closed_at":"2025-12-18T23:13:44.7771-08:00","close_reason":"Removed 8 stub functions (32 lines), tests pass, lint clean"}
{"id":"mcs-k7u","title":"Remove unused findSubcommand test helper","description":"## Problem\n`internal/cli/test_helpers_test.go:7-14` defines `findSubcommand()` but it's never called.\n\n```go\nfunc findSubcommand(cmd *cobra.Command, name string) *cobra.Command {\n    for _, c := range cmd.Commands() {\n        if c.Name() == name {\n            return c\n        }\n    }\n    return nil\n}\n```\n\n## Solution\nDelete the function.\n\n## Verification\n```bash\ngrep -r \"findSubcommand\" internal/\n# Should only show the definition, no call sites\n```","status":"closed","priority":4,"issue_type":"chore","created_at":"2025-12-18T23:08:08.800473-08:00","updated_at":"2025-12-18T23:19:46.72578-08:00","closed_at":"2025-12-18T23:19:46.72578-08:00","close_reason":"Invalid: function is actually used in 4 test files (charge_test, climate_test, raw_test, status_test)"}
{"id":"mcs-t6u","title":"Extract CLI command factory to reduce boilerplate","description":"## Problem\nCLI command files repeat similar patterns:\n\n- `internal/cli/lock.go` - NewLockCmd(), NewUnlockCmd()\n- `internal/cli/engine.go` - NewStartCmd(), NewStopCmd()  \n- `internal/cli/charge.go` - NewChargeCmd() with subcommands\n\nEach has ~25 lines of boilerplate for command construction.\n\n## Solution\nCreate a factory helper:\n\n```go\nfunc newVehicleCommand(use, short string, action func(context.Context, *api.Client, string) error) *cobra.Command {\n    return \u0026cobra.Command{\n        Use:   use,\n        Short: short,\n        RunE: func(cmd *cobra.Command, args []string) error {\n            return withVehicleClient(cmd.Context(), action)\n        },\n    }\n}\n```\n\n## Trade-off\nReduces lines but adds indirection. Consider if the current explicit approach is more readable.\n\n## Priority\nLow - this is cosmetic cleanup, current code is functional and clear.","status":"closed","priority":4,"issue_type":"chore","created_at":"2025-12-18T23:08:09.151912-08:00","updated_at":"2025-12-18T23:26:27.706105-08:00","closed_at":"2025-12-18T23:26:27.706105-08:00","close_reason":"Implemented command factory pattern, 94 net lines removed, tests added"}
{"id":"mcs-vfu","title":"Remove unused OtherInformation struct field from Vehicle","description":"## Problem\n`internal/api/types.go:74` has `OtherInformation` field in Vehicle struct, but all actual vehicle data extraction uses `VehicleInformationParsed` (line 250-252).\n\nThe raw `OtherInformation` contains a JSON string that gets parsed into typed fields elsewhere.\n\n## Investigation Needed\n1. Confirm `OtherInformation` field is never accessed directly\n2. Check if removing it breaks JSON unmarshaling\n\n## Solution\nIf unused, remove the field from the struct definition.\n\n## Risk\nLow - this is internal code, not public API.","status":"closed","priority":4,"issue_type":"chore","created_at":"2025-12-18T23:08:08.976993-08:00","updated_at":"2025-12-18T23:21:31.302423-08:00","closed_at":"2025-12-18T23:21:31.302423-08:00","close_reason":"Removed unused OtherInformation field and struct, updated test"}
